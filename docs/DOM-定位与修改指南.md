# SillyTavern DOM 定位与修改指南

在酒馆插件开发中，jQuery 是我们的“手术刀”。想要修改界面或添加元素，核心在于：**找到正确的地址（选择器）**。

---

## 1. 核心概念：如何找到“地址”？

酒馆的每一个按钮、输入框、面板都是一个 HTML 元素。我们要通过 **ID** 或 **Class** 来告诉 jQuery 我们要操作谁。

### 常用选择器
*   `#id`：精准定位（例如 `#send_but`），通常一个页面只有一个。
*   `.class`：定位一类元素（例如 `.menu_button`），通常用于批量修改样式。
*   `标签名`：定位所有同类标签（例如 `iframe`），需谨慎使用。

---

## 2. 开发者工具：你的“显微镜”

你不需要背诵酒馆的代码。利用浏览器的 **“检查（Inspect）”** 功能可以实时查看：

1.  **打开方式**：在酒馆页面上，对着你想修改的地方**右键 -> 检查**（或者按 `F12`）。
2.  **查看 HTML**：
    *   看看它有没有 `id="..."`（这是最稳妥的定位方式）。
    *   看看它有没有 `class="..."`。
3.  **调试**：你可以在浏览器的 `Console`（控制台）里直接输入 `$('#send_but').hide()` 来预览效果。

---

## 3. 常用“手术”指令

一旦找到了选择器（假设为 `target`），你可以进行以下操作：

### A. 添加新器官（注入元素）
*   `$(target).append(html)`：在内部的**最后面**插入。
*   `$(target).prepend(html)`：在内部的**最前面**插入。
*   `$(target).before(html)`：在它的**前面（同级）**插入。
*   `$(target).after(html)`：在它的**后面（同级）**插入。

> 想做“显示面板/信息面板”的完整实战流程（F12 取 selector → Console 验证 → JS 注入 + 防重复），请看：[`添加显示面板指南.md`](./添加显示面板指南.md)

### B. 修改现有器官（属性与样式）
*   `$(target).text('新文字')`：改文字。
*   `$(target).addClass('className')`：加样式类。
*   `$(target).css('color', 'red')`：直接改颜色/大小。
*   `$(target).prop('disabled', true)`：禁用按钮。

### C. 摘除器官（隐藏与删除）
*   `$(target).hide()`：看不见，但还在（推荐）。
*   `$(target).remove()`：彻底从代码里删掉（慎用）。

---

## 4. 必知必会的“地址簿”（常用 ID）

以下是酒馆中一些稳定的“地标”，你可以直接拿来参考：

| 元素描述 | ID / Class | 用途建议 |
| :--- | :--- | :--- |
| **发送按钮** | `#send_but` | 在它旁边加个快捷功能图标。 |
| **文本输入框** | `#user_input` | 自动填入文本或清空内容。 |
| **聊天记录容器**| `#chat` | 监控消息，或者在对话间插入提示。 |
| **侧边栏扩展设置**| `#extensions_settings` | 挂载你的插件设置面板。 |
| **顶部标题栏** | `#top-bar` | 添加全局控制按钮。 |
| **左侧抽屉栏** | `#left-drawer` | 添加新的功能菜单项。 |

---

## 5. 开发禁忌

1.  **不要乱改 ID**：你可以读取 ID，但尽量不要修改原生元素的 `id` 属性，否则酒馆的脚本会找不到它们。
2.  **注意层级 (z-index)**：如果你添加了一个悬浮窗，记得在 CSS 里给它一个很高的 `z-index`（如 9999），否则它可能会被酒馆的其他面板挡住。
3.  **不要硬编码颜色**：尽量使用 `var(--mainColor)` 等 CSS 变量，否则用户换个主题，你的插件就变成了“伤疤”。
4.  **等待 APP_READY**：页面还没加载完就去查找 `#send_but` 是找不到的。始终把修改代码放在 `eventSource.on(event_types.APP_READY, ...)` 之后。

---
